{% extends 'base_content.html' %}

{% block content %}
<div class="container">
    <form method="get" action="{% url 'task_search' %}" id="taskForm">
        {% csrf_token %}
        <nav class="navbar navbar-expand-lg bg-body-tertiary">
            <div class="container-fluid">
                <div class="collapse navbar-collapse" id="navbarSupportedContent">
                    <input class="form-control me-2" name="q" type="search" placeholder="Search"
                           aria-label="Search">
                    <button class="btn btn-outline-success" type="submit">Search</button>
                </div>
            </div>
        </nav>
    </form>
    <table class="table table-striped">
        <thead>
        <tr>
            <th scope="col">Task name</th>
            <th scope="col">Description</th>
            <th scope="col">Due date
                {% if request.GET.sort_column == 'due_date' and request.GET.sort_direction == 'desc' %}
                        <a href="{% url 'task_search' %}?sort_column=due_date&sort_direction=asc">
                            <i class="bi bi-arrow-down"></i>
                        </a>
                    {% else %}
                        <a href="{% url 'task_search' %}?sort_column=due_date&sort_direction=desc">
                            <i class="bi bi-arrow-up"></i>
                        </a>
                     {% endif %}
            </th>
            <th scope="col">priority
                {% if request.GET.sort_column == 'priority' and request.GET.sort_direction == 'desc' %}
                <a href="{% url 'task_search' %}?sort_column=priority&sort_direction=asc">
                    <i class="bi bi-arrow-down"></i>
                </a>
                {% else %}
                <a href="{% url 'task_search' %}?sort_column=priority&sort_direction=desc">
                    <i class="bi bi-arrow-up"></i>
                </a>
                {% endif %}
            </th>
        </thead>
        <tbody>
        {% for task in data %}
        <tr>
            <td>{{ task.name }}</td>
            <td style="max-width:420px;word-wrap:break-word;">{{ task.description }}</td>
            <td>{{ task.due_date }}</td>
            <td>{{ task.priority }}</td>
        </tr>
        {% endfor %}
        {% if no_tasks_found %}
        <tr>
            <td colspan="3">No tasks found.</td>
        </tr>
        {% endif %}
        </tbody>
    </table>
</div>
{% endblock %}
